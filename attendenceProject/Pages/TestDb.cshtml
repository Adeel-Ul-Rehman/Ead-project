@page
@model attendenceProject.Pages.TestDbModel
@{
    ViewData["Title"] = "Database Connection Test";
}

<div class="container mt-5">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h1 class="mb-4">🔍 Database Connection Test</h1>
            
            @if (Model.IsConnected)
            {
                <div class="alert alert-success">
                    <h4 class="alert-heading">✅ Database Connected Successfully!</h4>
                    <hr />
                    <p class="mb-0"><strong>Connection Status:</strong> Connected to UniversityAttendanceDB</p>
                </div>

                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">📊 Database Statistics</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Users</h6>
                                    <h3 class="mb-0">@Model.UserCount</h3>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Badges</h6>
                                    <h3 class="mb-0">@Model.BadgeCount</h3>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Sections</h6>
                                    <h3 class="mb-0">@Model.SectionCount</h3>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Courses</h6>
                                    <h3 class="mb-0">@Model.CourseCount</h3>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Students</h6>
                                    <h3 class="mb-0">@Model.StudentCount</h3>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="border p-3 rounded">
                                    <h6 class="text-muted">Teachers</h6>
                                    <h3 class="mb-0">@Model.TeacherCount</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <a href="/" class="btn btn-primary">Go to Home</a>
                </div>
            }
            else
            {
                <div class="alert alert-danger">
                    <h4 class="alert-heading">❌ Database Connection Failed</h4>
                    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                    {
                        <hr />
                        <p class="mb-0"><strong>Error:</strong></p>
                        <pre class="mt-2 p-3 bg-light rounded">@Model.ErrorMessage</pre>
                    }
                </div>
                
                <div class="mt-4">
                    <h5>Troubleshooting Steps:</h5>
                    <ol>
                        <li>Check your connection string in appsettings.Development.json</li>
                        <li>Ensure SQL Server is running</li>
                        <li>Verify database exists: UniversityAttendanceDB</li>
                        <li>Check firewall settings</li>
                    </ol>
                </div>
            }
        </div>
    </div>
</div>